{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\src\\\\ShopperContainer.js\";\nimport React, { Component } from 'react';\nimport Header from './Header.js';\nimport StoreShopperView from './StoreShopperView';\n\nvar ShopperContainer =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ShopperContainer, _Component);\n\n  function ShopperContainer(props) {\n    var _this;\n\n    _classCallCheck(this, ShopperContainer);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ShopperContainer).call(this, props));\n    _this.state = {\n      stores: [],\n      storeOwnershipState: 'loading' // ['loading', 'requestSent', 'noRequestSent']\n\n    };\n    _this.handleRequestStoreOwnership = _this.handleRequestStoreOwnership.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(ShopperContainer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var marketplace = this.props.marketplace;\n      var currentAccount = this.props.currentAccount;\n      var storeOwnershipState;\n      var stores;\n      marketplace.NewStoreCreated({}, {\n        fromBlock: 0,\n        toBlock: 'latest'\n      }).get(function (error, result) {\n        if (!error) {\n          stores = result.map(function (n) {\n            return n.args.store;\n          });\n          marketplace.getStoreOwnerRequests().then(function (storeOwnerRequests) {\n            storeOwnershipState = storeOwnerRequests.includes(currentAccount) ? 'requestSent' : 'noRequestSent';\n          }).then(function () {\n            return _this2.setState({\n              storeOwnershipState: storeOwnershipState,\n              stores: stores\n            });\n          });\n        }\n      });\n    }\n  }, {\n    key: \"handleRequestStoreOwnership\",\n    value: function handleRequestStoreOwnership() {\n      var _this3 = this;\n\n      this.setState({\n        storeOwnershipState: 'loading'\n      }, function () {\n        return _this3.props.marketplace.addStoreOwnerRequest({\n          from: _this3.props.currentAccount\n        });\n      });\n      this.props.marketplace.StoreOwnerRequestSent().watch(function (error, result) {\n        if (!error) {\n          var requestSent = result.args.storeOwnerRequestAddress === _this3.props.currentAccount;\n\n          if (requestSent) {\n            _this3.setState({\n              storeOwnershipState: 'requestSent'\n            });\n          }\n        } else {\n          console.log('error: ', error);\n        }\n      });\n    }\n  }, {\n    key: \"handleGoToStorePage\",\n    value: function handleGoToStorePage(storeId) {\n      console.log('handleGoToStorePage', storeId);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var stores = this.state.stores.length ? this.state.stores.map(function (store) {\n        return React.createElement(StoreShopperView, {\n          currentAccount: _this4.props.currentAccount,\n          web3: _this4.props.web3,\n          address: store,\n          key: store,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 68\n          },\n          __self: this\n        });\n      }) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }, \"There are no stores in the marketplace yet, check back later!\");\n      var requestStoreButton;\n\n      if (this.state.storeOwnershipState === 'loading') {\n        requestStoreButton = React.createElement(\"div\", {\n          style: {\n            position: 'absolute',\n            bottom: '15px',\n            left: '15px',\n            right: '15px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 76\n          },\n          __self: this\n        }, \"Loading...\");\n      } else if (this.state.storeOwnershipState === 'requestSent') {\n        requestStoreButton = React.createElement(\"div\", {\n          style: {\n            position: 'absolute',\n            bottom: '15px',\n            left: '15px',\n            right: '15px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 83\n          },\n          __self: this\n        }, \"Store ownership request sent, waiting for admin approval...\");\n      } else if (this.state.storeOwnershipState === 'noRequestSent') {\n        requestStoreButton = React.createElement(\"button\", {\n          style: {\n            position: 'absolute',\n            bottom: '15px',\n            left: '15px',\n            right: '15px'\n          },\n          onClick: this.handleRequestStoreOwnership,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90\n          },\n          __self: this\n        }, \"Request\");\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, React.createElement(Header, {\n        currentAccount: this.props.currentAccount,\n        pageTitle: \"Shopper Page\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        style: {\n          border: '1px solid #0000001e',\n          borderRadius: '4px',\n          backgroundColor: '#fafafa',\n          padding: '15px 15px 60px 15px',\n          margin: '15px',\n          position: 'relative'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          fontSize: '24px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, \"Become a Store Owner\"), requestStoreButton), React.createElement(\"div\", {\n        style: {\n          fontSize: '24px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, \"Shop\"), stores);\n    }\n  }]);\n\n  return ShopperContainer;\n}(Component);\n\nexport default ShopperContainer;","map":{"version":3,"sources":["C:\\Users\\Nikhil\\Documents\\GitHub\\ConsensysAcademy-Final-Project\\src\\ShopperContainer.js"],"names":["React","Component","Header","StoreShopperView","ShopperContainer","props","state","stores","storeOwnershipState","handleRequestStoreOwnership","bind","marketplace","currentAccount","NewStoreCreated","fromBlock","toBlock","get","error","result","map","n","args","store","getStoreOwnerRequests","then","storeOwnerRequests","includes","setState","addStoreOwnerRequest","from","StoreOwnerRequestSent","watch","requestSent","storeOwnerRequestAddress","console","log","storeId","length","web3","requestStoreButton","position","bottom","left","right","border","borderRadius","backgroundColor","padding","margin","fontSize"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport Header from './Header.js';\r\nimport StoreShopperView from './StoreShopperView';\r\n\r\n\r\nclass ShopperContainer extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      stores: [],\r\n      storeOwnershipState: 'loading' // ['loading', 'requestSent', 'noRequestSent']\r\n    }\r\n\r\n    this.handleRequestStoreOwnership = this.handleRequestStoreOwnership.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    const marketplace = this.props.marketplace;\r\n    const currentAccount = this.props.currentAccount;\r\n    let storeOwnershipState;\r\n    let stores;\r\n\r\n    marketplace.NewStoreCreated({}, { fromBlock: 0, toBlock: 'latest' }).get((error, result) => {\r\n      if (!error) {\r\n        stores = result.map(n => n.args.store);\r\n    \r\n        marketplace.getStoreOwnerRequests()\r\n          .then(storeOwnerRequests => {\r\n            storeOwnershipState = storeOwnerRequests.includes(currentAccount) \r\n                ? 'requestSent' \r\n                : 'noRequestSent';\r\n          })\r\n          .then(() => this.setState({\r\n            storeOwnershipState,\r\n            stores,\r\n          }));\r\n      }\r\n    });\r\n  }\r\n\r\n  handleRequestStoreOwnership() {\r\n    this.setState(\r\n      {storeOwnershipState: 'loading'}, \r\n      () => this.props.marketplace.addStoreOwnerRequest({from: this.props.currentAccount}));\r\n\r\n\r\n    this.props.marketplace.StoreOwnerRequestSent().watch((error, result) => {\r\n      if (!error) {\r\n        const requestSent = result.args.storeOwnerRequestAddress === this.props.currentAccount;\r\n        if (requestSent) {\r\n          this.setState({storeOwnershipState: 'requestSent'});\r\n        }\r\n      }\r\n      else {\r\n        console.log('error: ', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  handleGoToStorePage(storeId) {\r\n    console.log('handleGoToStorePage', storeId);\r\n  }\r\n\r\n  render() {\r\n    const stores = this.state.stores.length\r\n      ? this.state.stores.map(store =>\r\n          <StoreShopperView currentAccount={this.props.currentAccount} \r\n                            web3={this.props.web3} \r\n                            address={store} \r\n                            key={store}></StoreShopperView>)\r\n      : <div>There are no stores in the marketplace yet, check back later!</div>;\r\n\r\n    var requestStoreButton;\r\n    if (this.state.storeOwnershipState === 'loading') {\r\n      requestStoreButton = <div style={{\r\n                              position: 'absolute', \r\n                              bottom: '15px', \r\n                              left: '15px', \r\n                              right: '15px'}}>Loading...</div>;\r\n    }\r\n    else if (this.state.storeOwnershipState === 'requestSent') {\r\n      requestStoreButton = <div style={{\r\n                            position: 'absolute', \r\n                            bottom: '15px', \r\n                            left: '15px', \r\n                            right: '15px'}}>Store ownership request sent, waiting for admin approval...</div>;\r\n    }\r\n    else if (this.state.storeOwnershipState === 'noRequestSent') {\r\n      requestStoreButton = <button style={{\r\n                                      position: 'absolute', \r\n                                      bottom: '15px', \r\n                                      left: '15px', \r\n                                      right: '15px'}}\r\n                                   onClick={this.handleRequestStoreOwnership}>Request</button>;\r\n    }\r\n\r\n    return (\r\n      <div>\r\n        <Header currentAccount={this.props.currentAccount} pageTitle='Shopper Page'></Header>\r\n\r\n        <div style={{\r\n          border: '1px solid #0000001e', \r\n          borderRadius: '4px', \r\n          backgroundColor: '#fafafa',\r\n          padding: '15px 15px 60px 15px',\r\n          margin: '15px',\r\n          position: 'relative'}}>\r\n          <div style={{fontSize: '24px'}}>Become a Store Owner</div>\r\n          {requestStoreButton}\r\n        </div>\r\n\r\n        <div style={{fontSize: '24px'}}>Shop</div>\r\n        {stores}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ShopperContainer;\r\n"]},"metadata":{},"sourceType":"module"}