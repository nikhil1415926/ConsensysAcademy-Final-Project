{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Nikhil\\\\Documents\\\\GitHub\\\\ConsensysAcademy-Final-Project\\\\src\\\\StoreShopperView.js\";\nimport React, { Component } from 'react';\nimport StoreContract from '../build/contracts/Store.json';\n\nvar contract = require(\"truffle-contract\");\n\nvar StoreShopperView =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(StoreShopperView, _Component);\n\n  function StoreShopperView(props) {\n    var _this;\n\n    _classCallCheck(this, StoreShopperView);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(StoreShopperView).call(this, props));\n    _this.state = {\n      loading: true,\n      instance: null,\n      name: '',\n      description: '',\n      products: []\n    };\n    _this.updatePurchaseQuantity = _this.updatePurchaseQuantity.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.purchaseProduct = _this.purchaseProduct.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(StoreShopperView, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var storeContract = contract(StoreContract);\n      var instance;\n      var name;\n      var description;\n      var products;\n      storeContract.setProvider(this.props.web3.currentProvider);\n      storeContract.at(this.props.address) // save reference to store instance\n      .then(function (store) {\n        instance = store;\n        return store;\n      }) // call contract for store metadata \n      .then(function (store) {\n        return Promise.all([store.name(), store.description(), store.newestProductSku()]);\n      }) // save store metadata\n      .then(function (data) {\n        name = data[0];\n        description = data[1];\n        return data[2].toNumber();\n      }) // call contract for each products metadata\n      .then(function (newestProductSku) {\n        var result = [];\n\n        for (var i = 1; i <= newestProductSku; i++) {\n          result.push(instance.productsBySku(i));\n        }\n\n        return Promise.all(result);\n      }) // save product metadata\n      .then(function (data) {\n        console.log(name, data);\n        products = data.map(function (product) {\n          return {\n            sku: product[0].toNumber(),\n            inventoryCount: product[1].toNumber(),\n            price: product[2].toNumber(),\n            name: product[3],\n            description: product[4],\n            purchaseQuantity: 0\n          };\n        });\n      }) // update state with all the stuff we just fetched\n      .then(function () {\n        return _this2.setState({\n          instance: instance,\n          name: name,\n          description: description,\n          products: products,\n          loading: false\n        });\n      });\n    }\n  }, {\n    key: \"updatePurchaseQuantity\",\n    value: function updatePurchaseQuantity(sku, quantity) {\n      // this is a hack - mutating state directly\n      this.state.products.find(function (n) {\n        return n.sku === sku;\n      }).purchaseQuantity = quantity;\n      this.forceUpdate();\n    }\n  }, {\n    key: \"purchaseProduct\",\n    value: function purchaseProduct(product) {\n      this.state.instance.purchaseProduct.sendTransaction(product.sku, product.purchaseQuantity, {\n        from: this.props.currentAccount,\n        value: product.price * product.purchaseQuantity\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var products = this.state.products.length ? this.state.products.map(function (product) {\n        return React.createElement(\"div\", {\n          key: product.sku,\n          style: {\n            borderBottom: '1px solid #0000001e',\n            margin: '0 auto',\n            padding: '5px 0 5px 0',\n            overflow: 'auto'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: {\n            width: '100%',\n            marginBottom: '5px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: {\n            fontSize: '18px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105\n          },\n          __self: this\n        }, product.name), React.createElement(\"div\", {\n          style: {\n            fontSize: '12px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106\n          },\n          __self: this\n        }, product.description)), React.createElement(\"div\", {\n          style: {\n            float: 'left'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: {\n            fontSize: '18px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109\n          },\n          __self: this\n        }, _this3.props.web3.fromWei(product.price, \"ether\")), React.createElement(\"div\", {\n          style: {\n            fontSize: '12px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }, \"Price (ETH)\")), React.createElement(\"div\", {\n          style: {\n            float: 'right'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          type: \"number\",\n          style: {\n            width: '50px',\n            marginRight: '5px'\n          },\n          value: product.purchaseQuantity,\n          onChange: function onChange(e) {\n            return _this3.updatePurchaseQuantity(product.sku, e.target.value);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        }), React.createElement(\"button\", {\n          onClick: function onClick() {\n            return _this3.purchaseProduct(product);\n          },\n          type: \"button\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }, \"Purchase\")), React.createElement(\"div\", {\n          style: {\n            fontSize: '12px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121\n          },\n          __self: this\n        }, \"Quantity\")));\n      }) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, \"None yet...\");\n      return React.createElement(\"div\", {\n        style: {\n          border: '1px solid #0000001e',\n          borderRadius: '4px',\n          backgroundColor: '#fafafa',\n          width: '33%',\n          padding: '15px 15px 60px 15px',\n          position: 'relative',\n          display: 'inline-block',\n          verticalAlign: 'top',\n          margin: '15px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, this.state.loading ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, \"Loading...\") : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          fontSize: '24px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, this.state.name), React.createElement(\"div\", {\n        style: {\n          fontSize: '14px',\n          height: '20px',\n          width: '100%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, this.state.description), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, \"Products\"), products));\n    }\n  }]);\n\n  return StoreShopperView;\n}(Component);\n\nexport default StoreShopperView;","map":{"version":3,"sources":["C:\\Users\\Nikhil\\Documents\\GitHub\\ConsensysAcademy-Final-Project\\src\\StoreShopperView.js"],"names":["React","Component","StoreContract","contract","require","StoreShopperView","props","state","loading","instance","name","description","products","updatePurchaseQuantity","bind","purchaseProduct","storeContract","setProvider","web3","currentProvider","at","address","then","store","Promise","all","newestProductSku","data","toNumber","result","i","push","productsBySku","console","log","map","product","sku","inventoryCount","price","purchaseQuantity","setState","quantity","find","n","forceUpdate","sendTransaction","from","currentAccount","value","length","borderBottom","margin","padding","overflow","width","marginBottom","fontSize","float","fromWei","marginRight","e","target","border","borderRadius","backgroundColor","position","display","verticalAlign","height"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport StoreContract from '../build/contracts/Store.json'\r\n\r\nconst contract = require(\"truffle-contract\");\r\n\r\n\r\nclass StoreShopperView extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      loading: true,\r\n      instance: null,\r\n      name: '',\r\n      description: '',\r\n      products: [],\r\n    };\r\n\r\n    this.updatePurchaseQuantity = this.updatePurchaseQuantity.bind(this);\r\n    this.purchaseProduct = this.purchaseProduct.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    const storeContract = contract(StoreContract);\r\n    let instance;\r\n    let name;\r\n    let description;\r\n    let products;\r\n\r\n    storeContract.setProvider(this.props.web3.currentProvider);\r\n    storeContract.at(this.props.address)\r\n      // save reference to store instance\r\n      .then(store => {\r\n        instance = store;\r\n        return store;\r\n      })\r\n      // call contract for store metadata \r\n      .then(store => Promise.all([\r\n        store.name(), \r\n        store.description(),\r\n        store.newestProductSku()\r\n      ]))\r\n      // save store metadata\r\n      .then(data => {\r\n        name = data[0];\r\n        description = data[1];\r\n        return data[2].toNumber();\r\n      })\r\n      // call contract for each products metadata\r\n      .then(newestProductSku => {\r\n        const result = [];\r\n        for (let i = 1; i <= newestProductSku; i++) {\r\n          result.push(instance.productsBySku(i));\r\n        }\r\n        return Promise.all(result);\r\n      })\r\n      // save product metadata\r\n      .then(data => {\r\n        console.log(name, data);\r\n        products = data.map(product => ({\r\n          sku: product[0].toNumber(), \r\n          inventoryCount: product[1].toNumber(),\r\n          price: product[2].toNumber(),\r\n          name: product[3], \r\n          description: product[4],\r\n          purchaseQuantity: 0\r\n        }))\r\n      })\r\n      // update state with all the stuff we just fetched\r\n      .then(() => this.setState({\r\n        instance,\r\n        name,\r\n        description,\r\n        products,\r\n        loading: false\r\n      }));\r\n  }\r\n\r\n  updatePurchaseQuantity(sku, quantity) {\r\n    // this is a hack - mutating state directly\r\n    this.state.products.find(n => n.sku === sku).purchaseQuantity = quantity;\r\n    this.forceUpdate()\r\n  }\r\n\r\n  purchaseProduct(product) {\r\n    this.state.instance.purchaseProduct.sendTransaction(\r\n      product.sku, \r\n      product.purchaseQuantity, \r\n      {\r\n        from: this.props.currentAccount, \r\n        value: product.price * product.purchaseQuantity\r\n      });\r\n  }\r\n\r\n  render() {\r\n    const products = this.state.products.length \r\n      ? this.state.products.map(product => \r\n          <div key={product.sku}\r\n               style={{\r\n                  borderBottom: '1px solid #0000001e', \r\n                  margin: '0 auto',\r\n                  padding: '5px 0 5px 0',\r\n                  overflow: 'auto'}}>\r\n            <div style={{width: '100%', marginBottom: '5px'}}>\r\n              <div style={{fontSize: '18px'}}>{product.name}</div>\r\n              <div style={{fontSize: '12px'}}>{product.description}</div>\r\n            </div>\r\n            <div style={{float: 'left'}}>\r\n              <div style={{fontSize: '18px'}}>{this.props.web3.fromWei(product.price, \"ether\")}</div>\r\n              <div style={{fontSize: '12px'}}>Price (ETH)</div>\r\n            </div>\r\n            <div style={{float: 'right'}}>\r\n              <div>\r\n                <input type=\"number\" \r\n                       style={{width: '50px', marginRight: '5px'}}\r\n                       value={product.purchaseQuantity} \r\n                       onChange={(e) => this.updatePurchaseQuantity(product.sku, e.target.value)} />\r\n                <button onClick={() => this.purchaseProduct(product)} \r\n                        type=\"button\">Purchase</button>\r\n              </div>\r\n              <div style={{fontSize: '12px'}}>Quantity</div>\r\n            </div>\r\n          </div>) \r\n      : <div>None yet...</div>;\r\n\r\n    return (\r\n      <div style={{\r\n        border: '1px solid #0000001e', \r\n        borderRadius: '4px', \r\n        backgroundColor: '#fafafa',\r\n        width: '33%',\r\n        padding: '15px 15px 60px 15px',\r\n        position: 'relative',\r\n        display: 'inline-block',\r\n        verticalAlign: 'top',\r\n        margin: '15px'}}>\r\n\r\n        {this.state.loading \r\n          ? <div>Loading...</div> \r\n          : (\r\n              <div>\r\n                <div style={{fontSize: '24px' }}>{this.state.name}</div>\r\n                <div style={{fontSize: '14px', height: '20px', width: '100%'}}>{this.state.description}</div>\r\n\r\n                <br />\r\n\r\n                <div>Products</div>\r\n                {products}\r\n              </div>\r\n            )\r\n        }\r\n      </div>);\r\n  }\r\n}\r\n\r\nexport default StoreShopperView;\r\n"]},"metadata":{},"sourceType":"module"}